<!DOCTYPE html>
<html ng-app="contactos">
<head>
    <meta charset="UTF-8">
    <title>Contactos</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
    <style>
        .jumbotron{
            width: 550px;
            text-align: center;
            margin-top: 20px;
            margin-left: auto;
            margin-right: auto;
        }
        .table{
            margin-top: 20px;
        }
        .form-control{
            margin-bottom: 5px;
        }
        .selecionado{
            background-color: bisque;
        }
        .negrito{
            font-weight: bold; 
        }
        .cores{
            width: 20px; 
            height: 20px;
        } 
    </style>
    <script src="ajs/angular.js"></script>
    <script src="ajs/angular-messages.js"></script>
    <script>
        angular.module("contactos", ["ngMessages"]);
        angular.module("contactos").controller("contactosController", function ($scope) {
            $scope.message = "Lista de Contactos";
            $scope.contactos = [
                {nome: "Jos√©", telefone: "84123", email: "jose@gmail.com", operadora: {nome: "Vodacom", codigo: "84", categoria: "Cell"}},
                {nome: "Ana", telefone: "82123", email: "ana@gmail.com", operadora: {nome: "Mcel", codigo: "82", categoria: "Cell"}},
                {nome: "Maria", telefone: "86123", email: "maria@gmail.com", operadora: {nome: "Movitel", codigo: "86", categoria: "Cell"}}

            ];
            $scope.operadoras = [
                {nome: "Vodacom", codigo: "84", categoria: "Cell"},
                {nome: "Mcel", codigo: "82", categoria: "Cell"},
                {nome: "Movitel", codigo: "86", categoria: "Cell"},
                {nome: "TDM", codigo: "21", categoria: "Fixo"},
                {nome: "Tv Cabo", codigo: "22", categoria: "Fixo"}
             ];
            $scope.adicionarContacto = function (contacto) {
                $scope.contactos.push(angular.copy(contacto));
                delete $scope.contacto;
                $scope.contactoForm.$setPristine(); 
            }
            $scope.apagarContacto = function (contactos) {
                  $scope.contactos = contactos.filter(function (contacto) {
                      if(!contacto.selecionado)
                        return contacto;
                  });
            }
            $scope.isContactoSelecionado = function (contactos) {
                return contactos.some(function (contacto) {
                    return contacto.selecionado;
                });
            }
            $scope.selecionado = "selecionado";
            $scope.negrito = "negrito";
        });
    </script>
</head>
<body>
    <div ng-controller="contactosController">
        <div class="jumbotron">
            <h4>{{message}}</h4>
            <input class="form-control" type="text" ng-model="pesquisar" placeholder="Pesquisar...">
            <table ng-show="contactos.length > 0" class="table">
                <tr>
                    <th></th>
                    <th>Nome</th>
                    <th>Telefone</th>
                    <th>Email</th>
                    <th>Operadora</th>
                    <!-- <th>Cor</th> -->
                    <!-- <th>Data</th> -->
                </tr>
                <tr ng-class="{'selecionado negrito': contacto.selecionado}" ng-repeat="contacto in contactos | filter:pesquisar">
                    <td><input type="checkbox" ng-model="contacto.selecionado"></td>
                    <td>{{contacto.nome}}</td>
                    <td>{{contacto.telefone}}</td>
                    <td>{{contacto.email}}</td>
                    <td>{{contacto.operadora.nome}}</td>
                    <!-- <td><div class="cores" ng-style="{'background-color': contacto.cor}"></div></td> -->
                    <!-- <td>{{contacto.data | date:'dd/MM/yy'}}</td> -->
                </tr> 
            </table>
            <hr>
            <form name="contactoForm">
                <input type="text" class="form-control" placeholder="Nome" name="nome" ng-model="contacto.nome" ng-required="true" ng-minlength="2">
                <input type="number" class="form-control" placeholder="Telefone" name="telefone" ng-model="contacto.telefone" ng-required="true" ng-minlength="5">
                <input type="email" class="form-control" placeholder="Email" name="email" ng-model="contacto.email" ng-required="true">
                <select class="form-control" name="operadora" ng-model="contacto.operadora" ng-options="operadora.nome group by operadora.categoria for operadora in operadoras" ng-required="true">
                    <option value="">Selecione uma Operadora</option>
                </select>
            </form>

            <div ng-show="contactoForm.nome.$error.required && contactoForm.nome.$dirty" class="alert alert-danger">
                Preencha o nome!                         
            </div>
            <div ng-show="contactoForm.nome.$error.minlength" class="alert alert-danger">
                O nome deve ter pelo menos 2 carateres!
            </div>

            <div ng-show="contactoForm.telefone.$error.required && contactoForm.telefone.$dirty" class="alert alert-danger">
                Preencha o Telefone!                         
            </div>
            <div ng-show="contactoForm.telefone.$error.minlength" class="alert alert-danger">
                O nome telefone deve ter pelo menos 5 carateres!
            </div>
           
            <div ng-show="contactoForm.email.$error.required && contactoForm.email.$dirty" class="alert alert-danger">
                Preencha o Email!                         
            </div>
        
            <div ng-show="contactoForm.operadora.$invalid && contactoForm.operadora.$dirty" class="alert alert-danger">
                    Selecione a operadora!
            </div>
            <button class="btn btn-primary btn-block" ng-click="adicionarContacto(contacto)" ng-disabled="contactoForm.$invalid">Adicionar Contacto</button>
            <button class="btn btn-danger btn-block" ng-click="apagarContacto(contactos)" ng-show="isContactoSelecionado(contactos)">Apagar Contacto</button>

        </div>
    </div>
    <!-- <div ng-include="'footer.html'"></div> -->
</body>
</html>